Œ1
kC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
Env 
. 
Load 
( 	
Path	 
. 
Combine 
( 
	Directory 
.  
GetCurrentDirectory  3
(3 4
)4 5
,5 6
$str7 ;
,; <
$str= C
)C D
)D E
;E F
var 
dbHost 

= 
$str 
; 
var 
dbName 

= 
$str $
;$ %
var 
dbUser 

= 
Env 
. 
	GetString 
( 
$str $
)$ %
;% &
var 
dbPass 

= 
Env 
. 
	GetString 
( 
$str (
)( )
;) *
var 
connectionString 
= 
$" 
$str  
{  !
dbHost! '
}' (
$str( 2
{2 3
dbName3 9
}9 :
$str: @
{@ A
dbUserA G
}G H
$strH R
{R S
dbPassS Y
}Y Z
$strZ [
"[ \
;\ ]
builder 
. 
Services 
. 
AddDbContext 
< 
InventoryDbContext 0
>0 1
(1 2
options2 9
=>: <
options 
. 
UseMySql 
( 
connectionString %
,% &
ServerVersion' 4
.4 5

AutoDetect5 ?
(? @
connectionString@ P
)P Q
)Q R
) 
; 
builder 
. 
Services 
. 
	AddScoped 
< 
IUserRepository *
,* +
UserRepository, :
>: ;
(; <
)< =
;= >
builder 
. 
Services 
. 
	AddScoped 
< 
ISupplierRepository .
,. /
SupplierRepository0 B
>B C
(C D
)D E
;E F
builder 
. 
Services 
. 
	AddScoped 
< 
ICategoryRepository .
,. /
CategoryRepository0 B
>B C
(C D
)D E
;E F
builder 
. 
Services 
. 
	AddScoped 
< 
IProductRepository -
,- .
ProductRepository/ @
>@ A
(A B
)B C
;C D
builder 
. 
Services 
. 
	AddScoped 
< 
IPurchaseRepository .
,. /
PurchaseRepository0 B
>B C
(C D
)D E
;E F
builder 
. 
Services 
. 
	AddScoped 
< %
IPurchaseDetailRepository 4
,4 5$
PurchaseDetailRepository6 N
>N O
(O P
)P Q
;Q R
builder"" 
."" 
Services"" 
."" 
AddControllers"" 
(""  
)""  !
.""! "
AddJsonOptions""" 0
(""0 1
options""1 8
=>""9 ;
{## 
options$$ 
.$$ !
JsonSerializerOptions$$ !
.$$! "
ReferenceHandler$$" 2
=$$3 4
System$$5 ;
.$$; <
Text$$< @
.$$@ A
Json$$A E
.$$E F
Serialization$$F S
.$$S T
ReferenceHandler$$T d
.$$d e
IgnoreCycles$$e q
;$$q r
}%% 
)%% 
;%% 
builder&& 
.&& 
Services&& 
.&& #
AddEndpointsApiExplorer&& (
(&&( )
)&&) *
;&&* +
builder'' 
.'' 
Services'' 
.'' 
AddSwaggerGen'' 
('' 
)''  
;''  !
builder** 
.** 
Services** 
.** 
AddCors** 
(** 
options**  
=>**! #
{++ 
options,, 
.,, 
	AddPolicy,, 
(,, 
$str,, $
,,,$ %
policy-- 
=>-- 
{.. 	
policy// 
.// 
WithOrigins// 
(// 
$str// 6
)//6 7
.00 
AllowAnyHeader00 !
(00! "
)00" #
.11 
AllowAnyMethod11 !
(11! "
)11" #
.22 
AllowCredentials22 #
(22# $
)22$ %
;22% &
}33 	
)33	 

;33
 
}44 
)44 
;44 
var66 
app66 
=66 	
builder66
 
.66 
Build66 
(66 
)66 
;66 
if99 
(99 
app99 
.99 
Environment99 
.99 
IsDevelopment99 !
(99! "
)99" #
)99# $
{:: 
app;; 
.;; 

UseSwagger;; 
(;; 
);; 
;;; 
app<< 
.<< 
UseSwaggerUI<< 
(<< 
)<< 
;<< 
}== 
app@@ 
.@@ 
UseHttpsRedirection@@ 
(@@ 
)@@ 
;@@ 
appBB 
.BB 
UseCorsBB 
(BB 
$strBB 
)BB 
;BB 
appDD 
.DD 
UseAuthorizationDD 
(DD 
)DD 
;DD 
appFF 
.FF 
MapControllersFF 
(FF 
)FF 
;FF 
appHH 
.HH 
RunHH 
(HH 
)HH 	
;HH	 
á
ŽC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Infrastructure\Repositories\UserRepository.cs
	namespace 	
InventoryManagement
 
. 
Infrastructure ,
., -
Repositories- 9
{ 
public 

class 
UserRepository 
:  !
IUserRepository" 1
{		 
private

 
readonly

 
InventoryDbContext

 +
_context

, 4
;

4 5
public 
UserRepository 
( 
InventoryDbContext 0
context1 8
)8 9
{ 	
_context 
= 
context 
; 
} 	
public 
async 
Task 
< 
User 
? 
>  
GetByUsernameAsync! 3
(3 4
string4 :
username; C
)C D
{ 	
return 
await 
_context !
.! "
Users" '
.! "
FirstOrDefaultAsync" 5
(5 6
u6 7
=>8 :
u; <
.< =
Username= E
==F H
usernameI Q
)Q R
;R S
} 	
public 
async 
Task 
AddUserAsync &
(& '
User' +
user, 0
)0 1
{ 	
await 
_context 
. 
Users  
.  !
AddAsync! )
() *
user* .
). /
;/ 0
await 
_context 
. 
SaveChangesAsync +
(+ ,
), -
;- .
} 	
public 
async 
Task 
UpdateUserAsync )
() *
User* .
user/ 3
)3 4
{ 	
_context 
. 
Users 
. 
Update !
(! "
user" &
)& '
;' (
await   
_context   
.   
SaveChangesAsync   +
(  + ,
)  , -
;  - .
}!! 	
public## 
async## 
Task## 
<## 
List## 
<## 
User## #
>### $
>##$ %
GetAllUsersAsync##& 6
(##6 7
)##7 8
{$$ 	
return%% 
await%% 
_context%% !
.%%! "
Users%%" '
.%%' (
ToListAsync%%( 3
(%%3 4
)%%4 5
;%%5 6
}&& 	
public(( 
async(( 
Task(( 
<(( 
User(( 
?(( 
>((  
GetByIdAsync((! -
(((- .
short((. 3
id((4 6
)((6 7
{)) 	
return** 
await** 
_context** !
.**! "
Users**" '
.**' (
	FindAsync**( 1
(**1 2
id**2 4
)**4 5
;**5 6
}++ 	
},, 
}-- Ð
’C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Infrastructure\Repositories\SupplierRepository.cs
	namespace 	
InventoryManagement
 
. 
Infrastructure ,
., -
Repositories- 9
;9 :
public 
class 
SupplierRepository 
:  !
ISupplierRepository" 5
{		 
private

 
readonly

 
InventoryDbContext

 '
_context

( 0
;

0 1
public 

SupplierRepository 
( 
InventoryDbContext 0
context1 8
)8 9
{ 
_context 
= 
context 
; 
} 
public 

async 
Task 
< 
Supplier 
? 
>  
GetByIdAsync! -
(- .
short. 3
id4 6
)6 7
{ 
return 
await 
_context 
. 
	Suppliers '
.' (
	FindAsync( 1
(1 2
id2 4
)4 5
;5 6
} 
public 

async 
Task 
< 
List 
< 
Supplier #
># $
>$ %
GetAllAsync& 1
(1 2
)2 3
{ 
return 
await 
_context 
. 
	Suppliers '
.' (
ToListAsync( 3
(3 4
)4 5
;5 6
} 
public 

async 
Task 
AddAsync 
( 
Supplier '
supplier( 0
)0 1
{ 
await 
_context 
. 
	Suppliers  
.  !
AddAsync! )
() *
supplier* 2
)2 3
;3 4
await 
_context 
. 
SaveChangesAsync '
(' (
)( )
;) *
}   
public"" 

async"" 
Task"" 
UpdateAsync"" !
(""! "
Supplier""" *
supplier""+ 3
)""3 4
{## 
_context$$ 
.$$ 
	Suppliers$$ 
.$$ 
Update$$ !
($$! "
supplier$$" *
)$$* +
;$$+ ,
await%% 
_context%% 
.%% 
SaveChangesAsync%% '
(%%' (
)%%( )
;%%) *
}&& 
}'' ìO
’C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Infrastructure\Repositories\PurchaseRepository.cs
	namespace 	
InventoryManagement
 
. 
Infrastructure ,
., -
Repositories- 9
;9 :
public		 
class		 
PurchaseRepository		 
:		  !
IPurchaseRepository		" 5
{

 
private 
readonly 
InventoryDbContext '
_context( 0
;0 1
public 

PurchaseRepository 
( 
InventoryDbContext 0
context1 8
)8 9
{ 
_context 
= 
context 
; 
} 
public 

async 
Task 
AddAsync 
( 
CreatePurchaseDto 0
dto1 4
,4 5
short6 ;
userId< B
)B C
{ 
await 
using 
var 
transaction #
=$ %
await& +
_context, 4
.4 5
Database5 =
.= >!
BeginTransactionAsync> S
(S T
)T U
;U V
try 
{ 	
var 
supplier 
= 
await  
_context! )
.) *
	Suppliers* 3
.3 4
	FindAsync4 =
(= >
dto> A
.A B

SupplierIdB L
)L M
;M N
if 
( 
supplier 
== 
null  
)  !
{ 
throw 
new %
InvalidOperationException 3
(3 4
$str4 N
)N O
;O P
} 
var 

productIds 
= 
dto  
.  !
PurchaseDetails! 0
.0 1
Select1 7
(7 8
pd8 :
=>; =
pd> @
.@ A
	ProductIdA J
)J K
.K L
ToListL R
(R S
)S T
;T U
var   
productsFromDb   
=    
await  ! &
_context  ' /
.  / 0
Products  0 8
.!! 
Where!! 
(!! 
p!! 
=>!! 

productIds!! &
.!!& '
Contains!!' /
(!!/ 0
p!!0 1
.!!1 2
Id!!2 4
)!!4 5
)!!5 6
."" 
ToDictionaryAsync"" "
(""" #
p""# $
=>""% '
p""( )
."") *
Id""* ,
)"", -
;""- .
if$$ 
($$ 
productsFromDb$$ 
.$$ 
Count$$ $
!=$$% '

productIds$$( 2
.$$2 3
Count$$3 8
)$$8 9
{%% 
throw&& 
new&& %
InvalidOperationException&& 3
(&&3 4
$str&&4 `
)&&` a
;&&a b
}'' 
var)) 
purchase)) 
=)) 
new)) 
Purchase)) '
{** 

SupplierId++ 
=++ 
dto++  
.++  !

SupplierId++! +
,+++ ,
Supplier,, 
=,, 
supplier,, #
,,,# $
CreatedByUserId-- 
=--  !
userId--" (
,--( )
CreationDate.. 
=.. 
DateTime.. '
...' (
UtcNow..( .
,... /
ModificationDate//  
=//! "
DateTime//# +
.//+ ,
UtcNow//, 2
,//2 3
Status00 
=00 
$num00 
,00 
PurchaseDetails11 
=11  !
new11" %
List11& *
<11* +
PurchaseDetail11+ 9
>119 :
(11: ;
)11; <
}22 
;22 
decimal44 
total44 
=44 
$num44 
;44 
foreach66 
(66 
var66 
	detailDto66 "
in66# %
dto66& )
.66) *
PurchaseDetails66* 9
)669 :
{77 
var88 
product88 
=88 
productsFromDb88 ,
[88, -
	detailDto88- 6
.886 7
	ProductId887 @
]88@ A
;88A B
var:: 
detail:: 
=:: 
new::  
PurchaseDetail::! /
{;; 
	ProductId<< 
=<< 
	detailDto<<  )
.<<) *
	ProductId<<* 3
,<<3 4
Quantity== 
=== 
	detailDto== (
.==( )
Quantity==) 1
,==1 2
	UnitPrice>> 
=>> 
	detailDto>>  )
.>>) *
	UnitPrice>>* 3
,>>3 4
Purchase?? 
=?? 
purchase?? '
,??' (
Product@@ 
=@@ 
product@@ %
}AA 
;AA 
purchaseCC 
.CC 
PurchaseDetailsCC (
.CC( )
AddCC) ,
(CC, -
detailCC- 3
)CC3 4
;CC4 5
productEE 
.EE 

TotalStockEE "
+=EE# %
	detailDtoEE& /
.EE/ 0
QuantityEE0 8
;EE8 9
_contextFF 
.FF 
ProductsFF !
.FF! "
UpdateFF" (
(FF( )
productFF) 0
)FF0 1
;FF1 2
totalHH 
+=HH 
	detailDtoHH "
.HH" #
QuantityHH# +
*HH, -
	detailDtoHH. 7
.HH7 8
	UnitPriceHH8 A
;HHA B
}II 
purchaseKK 
.KK 
TotalPurchaseKK "
=KK# $
totalKK% *
;KK* +
awaitMM 
_contextMM 
.MM 
	PurchasesMM $
.MM$ %
AddAsyncMM% -
(MM- .
purchaseMM. 6
)MM6 7
;MM7 8
awaitOO 
_contextOO 
.OO 
SaveChangesAsyncOO +
(OO+ ,
)OO, -
;OO- .
awaitQQ 
transactionQQ 
.QQ 
CommitAsyncQQ )
(QQ) *
)QQ* +
;QQ+ ,
}RR 	
catchSS 
(SS 
	ExceptionSS 
)SS 
{TT 	
awaitUU 
transactionUU 
.UU 
RollbackAsyncUU +
(UU+ ,
)UU, -
;UU- .
throwVV 
;VV 
}WW 	
}XX 
publicZZ 

asyncZZ 
TaskZZ 
<ZZ 
ListZZ 
<ZZ 
PurchaseZZ #
>ZZ# $
>ZZ$ %
GetAllAsyncZZ& 1
(ZZ1 2
)ZZ2 3
{[[ 
return\\ 
await\\ 
_context\\ 
.\\ 
	Purchases\\ '
.]] 
Include]] 
(]] 
p]] 
=>]] 
p]] 
.]] 
Supplier]] $
)]]$ %
.^^ 
Include^^ 
(^^ 
p^^ 
=>^^ 
p^^ 
.^^ 
PurchaseDetails^^ +
)^^+ ,
.__ 
ThenInclude__ 
(__ 
pd__ 
=>__  "
pd__# %
.__% &
Product__& -
)__- .
.`` 
ToListAsync`` 
(`` 
)`` 
;`` 
}aa 
publiccc 

asynccc 
Taskcc 
<cc 
Listcc 
<cc 
Purchasecc #
>cc# $
>cc$ %
GetByUserIdAsynccc& 6
(cc6 7
shortcc7 <
userIdcc= C
)ccC D
{dd 
returnee 
awaitee 
_contextee 
.ee 
	Purchasesee '
.ff 
Whereff 
(ff 
pff 
=>ff 
pff 
.ff 
CreatedByUserIdff )
==ff* ,
userIdff- 3
)ff3 4
.gg 
Includegg 
(gg 
pgg 
=>gg 
pgg 
.gg 
Suppliergg $
)gg$ %
.hh 
Includehh 
(hh 
phh 
=>hh 
phh 
.hh 
PurchaseDetailshh +
)hh+ ,
.ii 
ThenIncludeii 
(ii 
pdii 
=>ii  "
pdii# %
.ii% &
Productii& -
)ii- .
.jj 
ToListAsyncjj 
(jj 
)jj 
;jj 
}kk 
publicmm 

asyncmm 
Taskmm 
<mm 
Purchasemm 
?mm 
>mm  
GetByIdAsyncmm! -
(mm- .
intmm. 1

purchaseIdmm2 <
)mm< =
{nn 
returnoo 
awaitoo 
_contextoo 
.oo 
	Purchasesoo '
.pp 
Includepp 
(pp 
ppp 
=>pp 
ppp 
.pp 
Supplierpp $
)pp$ %
.qq 
Includeqq 
(qq 
pqq 
=>qq 
pqq 
.qq 
PurchaseDetailsqq +
)qq+ ,
.rr 
ThenIncluderr 
(rr 
pdrr 
=>rr  "
pdrr# %
.rr% &
Productrr& -
)rr- .
.ss 
FirstOrDefaultAsyncss  
(ss  !
pss! "
=>ss# %
pss& '
.ss' (
Idss( *
==ss+ -

purchaseIdss. 8
)ss8 9
;ss9 :
}tt 
publicvv 

asyncvv 
Taskvv 
UpdateAsyncvv !
(vv! "
Purchasevv" *
purchasevv+ 3
)vv3 4
{ww 
purchasexx 
.xx 
ModificationDatexx !
=xx" #
DateTimexx$ ,
.xx, -
UtcNowxx- 3
;xx3 4
_contextyy 
.yy 
	Purchasesyy 
.yy 
Updateyy !
(yy! "
purchaseyy" *
)yy* +
;yy+ ,
awaitzz 
_contextzz 
.zz 
SaveChangesAsynczz '
(zz' (
)zz( )
;zz) *
}{{ 
}|| ê
˜C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Infrastructure\Repositories\PurchaseDetailRepository.cs
	namespace 	
InventoryManagement
 
. 
Infrastructure ,
., -
Repositories- 9
;9 :
public 
class $
PurchaseDetailRepository %
:& '%
IPurchaseDetailRepository( A
{		 
private

 
readonly

 
InventoryDbContext

 '
_context

( 0
;

0 1
public 
$
PurchaseDetailRepository #
(# $
InventoryDbContext$ 6
context7 >
)> ?
{ 
_context 
= 
context 
; 
} 
public 

async 
Task 
< 
List 
< 
PurchaseDetail )
>) *
>* +
GetAllAsync, 7
(7 8
)8 9
{ 
return 
await 
_context 
. 
PurchaseDetails -
. 
Include 
( 
pd 
=> 
pd 
. 
Product %
)% &
. 
Include 
( 
pd 
=> 
pd 
. 
Purchase &
)& '
. 
ToListAsync 
( 
) 
; 
} 
public 

async 
Task 
< 
List 
< 
PurchaseDetail )
>) *
>* + 
GetByPurchaseIdAsync, @
(@ A
intA D

purchaseIdE O
)O P
{ 
return 
await 
_context 
. 
PurchaseDetails -
. 
Where 
( 
pd 
=> 
pd 
. 

PurchaseId &
==' )

purchaseId* 4
)4 5
. 
Include 
( 
pd 
=> 
pd 
. 
Product %
)% &
. 
Include 
( 
pd 
=> 
pd 
. 
Purchase &
)& '
. 
ToListAsync 
( 
) 
; 
}   
public"" 

async"" 
Task"" 
AddAsync"" 
("" 
PurchaseDetail"" -
purchaseDetail"". <
)""< =
{## 
await$$ 
_context$$ 
.$$ 
PurchaseDetails$$ &
.$$& '
AddAsync$$' /
($$/ 0
purchaseDetail$$0 >
)$$> ?
;$$? @
await%% 
_context%% 
.%% 
SaveChangesAsync%% '
(%%' (
)%%( )
;%%) *
}&& 
public(( 

async(( 
Task(( 
UpdateAsync(( !
(((! "
PurchaseDetail((" 0
purchaseDetail((1 ?
)((? @
{)) 
_context** 
.** 
PurchaseDetails**  
.**  !
Update**! '
(**' (
purchaseDetail**( 6
)**6 7
;**7 8
await++ 
_context++ 
.++ 
SaveChangesAsync++ '
(++' (
)++( )
;++) *
},, 
}-- ¬
‘C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Infrastructure\Repositories\ProductRepository.cs
	namespace 	
InventoryManagement
 
. 
Infrastructure ,
., -
Repositories- 9
;9 :
public 
class 
ProductRepository 
:  
IProductRepository! 3
{		 
private

 
readonly

 
InventoryDbContext

 '
_context

( 0
;

0 1
public 

ProductRepository 
( 
InventoryDbContext /
context0 7
)7 8
{ 
_context 
= 
context 
; 
} 
public 

async 
Task 
< 
List 
< 
Product "
>" #
># $
GetAllAsync% 0
(0 1
)1 2
{ 
return 
await 
_context 
. 
Products &
.& '
ToListAsync' 2
(2 3
)3 4
;4 5
} 
public 

async 
Task 
AddAsync 
( 
Product &
product' .
). /
{ 
await 
_context 
. 
Products 
.  
AddAsync  (
(( )
product) 0
)0 1
;1 2
await 
_context 
. 
SaveChangesAsync '
(' (
)( )
;) *
} 
} ¸
’C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Infrastructure\Repositories\CategoryRepository.cs
	namespace 	
InventoryManagement
 
. 
Infrastructure ,
., -
Repositories- 9
;9 :
public 
class 
CategoryRepository 
:  !
ICategoryRepository" 5
{		 
private

 
readonly

 
InventoryDbContext

 '
_context

( 0
;

0 1
public 

CategoryRepository 
( 
InventoryDbContext 0
context1 8
)8 9
{ 
_context 
= 
context 
; 
} 
public 

async 
Task 
< 
List 
< 
Category #
># $
>$ %
GetAllAsync& 1
(1 2
)2 3
{ 
return 
await 
_context 
. 

Categories (
.( )
ToListAsync) 4
(4 5
)5 6
;6 7
} 
public 

async 
Task 
AddAsync 
( 
Category '
category( 0
)0 1
{ 
await 
_context 
. 

Categories !
.! "
AddAsync" *
(* +
category+ 3
)3 4
;4 5
await 
_context 
. 
SaveChangesAsync '
(' (
)( )
;) *
} 
} ¶
‘C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Infrastructure\Persistence\InventoryDbContext.cs
	namespace 	
InventoryManagement
 
. 
Infrastructure ,
., -
Persistence- 8
;8 9
public 
class 
InventoryDbContext 
:  !
	DbContext" +
{ 
public 

InventoryDbContext 
( 
DbContextOptions .
<. /
InventoryDbContext/ A
>A B
optionsC J
)J K
:L M
baseN R
(R S
optionsS Z
)Z [
{		 
}

 
public 

DbSet 
< 
Product 
> 
Products "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

DbSet 
< 
Supplier 
> 
	Suppliers $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

DbSet 
< 
Category 
> 

Categories %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 

DbSet 
< 
User 
> 
Users 
{ 
get "
;" #
set$ '
;' (
}) *
public 

DbSet 
< 
Purchase 
> 
	Purchases $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

DbSet 
< 
PurchaseDetail 
>  
PurchaseDetails! 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 

DbSet 
< 
SupplierProduct  
>  !
SupplierProducts" 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 

DbSet 
< 
ProductPriceHistory $
>$ %!
ProductPriceHistories& ;
{< =
get> A
;A B
setC F
;F G
}H I
	protected 
override 
void 
OnModelCreating +
(+ ,
ModelBuilder, 8
modelBuilder9 E
)E F
{ 
modelBuilder 
. 
Entity 
< 
PurchaseDetail *
>* +
(+ ,
), -
. 
HasKey 
( 
pd 
=> 
new 
{ 
pd  "
." #

PurchaseId# -
,- .
pd/ 1
.1 2
	ProductId2 ;
}< =
)= >
;> ?
modelBuilder 
. 
Entity 
< 
SupplierProduct +
>+ ,
(, -
)- .
. 
HasKey 
( 
sp 
=> 
new 
{ 
sp  "
." #

SupplierId# -
,- .
sp/ 1
.1 2
	ProductId2 ;
}< =
)= >
;> ?
modelBuilder 
. 
Entity 
< 
ProductPriceHistory /
>/ 0
(0 1
)1 2
. 
HasKey 
( 
ph 
=> 
new 
{ 
ph  "
." #
	ProductId# ,
,, -
ph. 0
.0 1

SupplierId1 ;
,; <
ph= ?
.? @

PurchaseId@ J
}K L
)L M
;M N
} 
}   ©
xC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Domain\Entities\User.cs
	namespace 	
InventoryManagement
 
. 
Domain $
.$ %
Entities% -
;- .
[ 
Table 
( 
$str 
) 
] 
public 
class 
User 
: 
AuditableEntity #
{		 
[

 
Key

 
]

 	
[ 
DatabaseGenerated 
( #
DatabaseGeneratedOption .
.. /
Identity/ 7
)7 8
]8 9
[ 

JsonIgnore 
] 
public 

short 
Id 
{ 
get 
; 
set 
; 
}  !
[ 
Required 
] 
[ 
	MaxLength 
( 
$num 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

string 
Username 
{ 
get  
;  !
set" %
;% &
}' (
=) *
null+ /
!/ 0
;0 1
[ 
Required 
] 
[ 
	MaxLength 
( 
$num 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

string 
PasswordHash 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
null/ 3
!3 4
;4 5
[ 
Required 
] 
[ 
	MaxLength 
( 
$num 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

string 
	FirstName 
{ 
get !
;! "
set# &
;& '
}( )
=* +
null, 0
!0 1
;1 2
[ 
Required 
] 
[ 
	MaxLength 
( 
$num 
) 
] 
[   
Column   
(   
$str   
)   
]   
public!! 

string!! 
LastName!! 
{!! 
get!!  
;!!  !
set!!" %
;!!% &
}!!' (
=!!) *
null!!+ /
!!!/ 0
;!!0 1
[## 
	MaxLength## 
(## 
$num## 
)## 
]## 
[$$ 
Column$$ 
($$ 
$str$$ 
)$$ 
]$$  
public%% 

string%% 
?%% 
SecondLastName%% !
{%%" #
get%%$ '
;%%' (
set%%) ,
;%%, -
}%%. /
['' 
Required'' 
]'' 
[(( 
	MaxLength(( 
((( 
$num(( 
)(( 
](( 
[)) 
Column)) 
()) 
$str)) 
))) 
])) 
public** 

string** 
Role** 
{** 
get** 
;** 
set** !
;**! "
}**# $
=**% &
null**' +
!**+ ,
;**, -
}++ ê
ƒC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Domain\Entities\SupplierProduct.cs
	namespace 	
InventoryManagement
 
. 
Domain $
.$ %
Entities% -
;- .
[ 
Table 
( 
$str 
) 
] 
public 
class 
SupplierProduct 
: 
AuditableEntity .
{ 
public 

short 

SupplierId 
{ 
get !
;! "
set# &
;& '
}( )
public		 

short		 
	ProductId		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
[ 
Column 
( 
TypeName 
= 
$str '
)' (
]( )
public 

decimal 
ProductCost 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

required 
virtual 
Supplier $
Supplier% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 

required 
virtual 
Product #
Product$ +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
} »
|C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Domain\Entities\Supplier.cs
	namespace 	
InventoryManagement
 
. 
Domain $
.$ %
Entities% -
;- .
[ 
Table 
( 
$str 
) 
] 
public 
class 
Supplier 
: 
AuditableEntity '
{		 
[

 
Key

 
]

 	
[ 
DatabaseGenerated 
( #
DatabaseGeneratedOption .
.. /
Identity/ 7
)7 8
]8 9
[ 

JsonIgnore 
] 
public 

short 
Id 
{ 
get 
; 
set 
; 
}  !
[ 
Required 
] 
[ 
	MaxLength 
( 
$num 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
[ 
	MaxLength 
( 
$num 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

string 
? 
Nit 
{ 
get 
; 
set !
;! "
}# $
[ 
Column 
( 
$str 
) 
] 
public 

string 
? 
Address 
{ 
get  
;  !
set" %
;% &
}' (
[ 
	MaxLength 
( 
$num 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

string 
? 
Phone 
{ 
get 
; 
set  #
;# $
}% &
[ 
	MaxLength 
( 
$num 
) 
] 
[   
Column   
(   
$str   
)   
]   
public!! 

string!! 
?!! 
Email!! 
{!! 
get!! 
;!! 
set!!  #
;!!# $
}!!% &
[## 
	MaxLength## 
(## 
$num## 
)## 
]## 
[$$ 
Column$$ 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 

string%% 
?%% 
ContactName%% 
{%%  
get%%! $
;%%$ %
set%%& )
;%%) *
}%%+ ,
public(( 

virtual(( 
ICollection(( 
<(( 
SupplierProduct(( .
>((. /
SupplierProducts((0 @
{((A B
get((C F
;((F G
set((H K
;((K L
}((M N
=((O P
new((Q T
List((U Y
<((Y Z
SupplierProduct((Z i
>((i j
(((j k
)((k l
;((l m
})) ú
‚C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Domain\Entities\PurchaseDetail.cs
	namespace 	
InventoryManagement
 
. 
Domain $
.$ %
Entities% -
;- .
[ 
Table 
( 
$str 
) 
] 
public 
class 
PurchaseDetail 
{ 
[		 
JsonRequired		 
]		 
[

 
Column

 
(

 
$str

 
)

 
]

 
public 

int 

PurchaseId 
{ 
get 
;  
set! $
;$ %
}& '
[ 
JsonRequired 
] 
[ 
Column 
( 
$str 
) 
] 
public 

short 
	ProductId 
{ 
get  
;  !
set" %
;% &
}' (
[ 
JsonRequired 
] 
[ 
Column 
( 
$str 
) 
] 
public 

short 
Quantity 
{ 
get 
;  
set! $
;$ %
}& '
[ 
JsonRequired 
] 
[ 
Column 
( 
$str 
, 
TypeName "
=# $
$str% 5
)5 6
]6 7
public 

decimal 
	UnitPrice 
{ 
get "
;" #
set$ '
;' (
}) *
public 

required 
virtual 
Purchase $
Purchase% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 

required 
virtual 
Product #
Product$ +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
} Ç
|C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Domain\Entities\Purchase.cs
	namespace 	
InventoryManagement
 
. 
Domain $
.$ %
Entities% -
;- .
[ 
Table 
( 
$str 
) 
] 
public 
class 
Purchase 
: 
AuditableEntity '
{		 
[

 
Key

 
]

 	
[ 
DatabaseGenerated 
( #
DatabaseGeneratedOption .
.. /
Identity/ 7
)7 8
]8 9
[ 

JsonIgnore 
] 
[ 
Column 
( 
$str 
) 
] 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
[ 
Required 
] 
[ 
JsonRequired 
] 
[ 
Column 
( 
$str 
, 
TypeName &
=' (
$str) 9
)9 :
]: ;
public 

decimal 
TotalPurchase  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 
Required 
] 
[ 
JsonRequired 
] 
[ 

ForeignKey 
( 
$str 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

short 

SupplierId 
{ 
get !
;! "
set# &
;& '
}( )
public 

required 
virtual 
Supplier $
Supplier% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 

required 
virtual 
ICollection '
<' (
PurchaseDetail( 6
>6 7
PurchaseDetails8 G
{H I
getJ M
;M N
setO R
;R S
}T U
} Î
‡C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Domain\Entities\ProductPriceHistory.cs
	namespace 	
InventoryManagement
 
. 
Domain $
.$ %
Entities% -
;- .
[ 
Table 
( 
$str 
) 
]  
public 
class 
ProductPriceHistory  
{ 
public 

short 
	ProductId 
{ 
get  
;  !
set" %
;% &
}' (
public		 

short		 

SupplierId		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 

int

 

PurchaseId

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
[ 
Column 
( 
TypeName 
= 
$str '
)' (
]( )
public 

decimal 
PurchasePrice  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
PurchaseDate  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

required 
virtual 
Product #
Product$ +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 

required 
virtual 
Supplier $
Supplier% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 

required 
virtual 
Purchase $
Purchase% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
} è
{C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Domain\Entities\Product.cs
	namespace 	
InventoryManagement
 
. 
Domain $
.$ %
Entities% -
;- .
[ 
Table 
( 
$str 
) 
] 
public 
class 
Product 
: 
AuditableEntity &
{		 
[

 
Key

 
]

 	
[ 
JsonRequired 
] 
[ 
Column 
( 
$str 
) 
] 
public 

short 
Id 
{ 
get 
; 
set 
; 
}  !
[ 
Required 
] 
[ 
	MaxLength 
( 
$num 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
[ 
Column 
( 
$str 
) 
] 
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 
Column 
( 
$str 
) 
] 
public 

short 

TotalStock 
{ 
get !
;! "
set# &
;& '
}( )
=* +
$num, -
;- .
[ 

ForeignKey 
( 
$str 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

required 
short 

CategoryId $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

virtual 
Category 
Category $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
null5 9
!9 :
;: ;
public!! 

virtual!! 
ICollection!! 
<!! 
SupplierProduct!! .
>!!. /
SupplierProducts!!0 @
{!!A B
get!!C F
;!!F G
set!!H K
;!!K L
}!!M N
=!!O P
new!!Q T
List!!U Y
<!!Y Z
SupplierProduct!!Z i
>!!i j
(!!j k
)!!k l
;!!l m
public$$ 

virtual$$ 
ICollection$$ 
<$$ 
PurchaseDetail$$ -
>$$- .
PurchaseDetails$$/ >
{$$? @
get$$A D
;$$D E
set$$F I
;$$I J
}$$K L
=$$M N
new$$O R
List$$S W
<$$W X
PurchaseDetail$$X f
>$$f g
($$g h
)$$h i
;$$i j
}%% ß
|C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Domain\Entities\Category.cs
	namespace 	
InventoryManagement
 
. 
Domain $
.$ %
Entities% -
;- .
[ 
Table 
( 
$str 
) 
] 
public 
class 
Category 
: 
AuditableEntity '
{		 
[

 
Key

 
]

 	
[ 
DatabaseGenerated 
( #
DatabaseGeneratedOption .
.. /
Identity/ 7
)7 8
]8 9
[ 

JsonIgnore 
] 
[ 
Column 
( 
$str 
) 
] 
public 

short 
Id 
{ 
get 
; 
set 
; 
}  !
[ 
Required 
] 
[ 
	MaxLength 
( 
$num 
) 
] 
[ 
Column 
( 
$str 
) 
] 
public 

required 
string 
Name 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
[ 
Column 
( 
$str 
) 
] 
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

virtual 
ICollection 
< 
Product &
>& '
Products( 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
=? @
newA D
ListE I
<I J
ProductJ Q
>Q R
(R S
)S T
;T U
} È
ƒC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Domain\Entities\AuditableEntity.cs
	namespace 	
InventoryManagement
 
. 
Domain $
.$ %
Entities% -
;- .
public 
abstract 
class 
AuditableEntity %
{ 
[ 
Column 
( 
$str 
) 
]  
public 

short 
? 
CreatedByUserId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[

 
JsonRequired

 
]

 
[ 
Column 
( 
$str 
) 
] 
public 

DateTime 
CreationDate  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 
JsonRequired 
] 
[ 
Column 
( 
$str 
)  
]  !
public 

DateTime 
ModificationDate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 
JsonRequired 
] 
[ 
Column 
( 
$str 
) 
] 
public 

byte 
Status 
{ 
get 
; 
set !
;! "
}# $
public 

virtual 
User 
? 
CreatedByUser &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
null7 ;
!; <
;< =
} ÑR
C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Controllers\UsersController.cs
	namespace 	
InventoryManagement
 
. 
Controllers )
;) *
[		 
ApiController		 
]		 
[

 
Route

 
(

 
$str

 
)

 
]

 
public 
class 
UsersController 
: 
ControllerBase -
{ 
private 
readonly 
InventoryDbContext '
_context( 0
;0 1
private 
const 
string 
	AdminRole "
=# $
$str% ,
;, -
public 

UsersController 
( 
InventoryDbContext -
context. 5
)5 6
{ 
_context 
= 
context 
; 
} 
[ 
HttpPost 
] 
public 

async 
Task 
< 
IActionResult #
># $

CreateUser% /
(/ 0
[0 1
FromBody1 9
]9 :
CreateUserDto; H
userDtoI P
,P Q
[R S

FromHeaderS ]
]] ^
string_ e
userRolef n
)n o
{ 
if 

( 
userRole 
!= 
	AdminRole !
)! "
{ 	
return 
Forbid 
( 
$str G
)G H
;H I
} 	
if 

( 
userDto 
== 
null 
) 
{ 	
return   

BadRequest   
(   
)   
;    
}!! 	
var## 
newUser## 
=## 
new## 
User## 
{$$ 	
Username%% 
=%% 
userDto%% 
.%% 
Username%% '
!%%' (
,%%( )
PasswordHash'' 
='' 
userDto'' "
.''" #
Password''# +
!''+ ,
,'', -
	FirstName(( 
=(( 
userDto(( 
.((  
	FirstName((  )
!(() *
,((* +
LastName)) 
=)) 
userDto)) 
.)) 
LastName)) '
!))' (
,))( )
SecondLastName** 
=** 
userDto** $
.**$ %
SecondLastName**% 3
,**3 4
Role++ 
=++ 
userDto++ 
.++ 
Role++ 
!++  
,++  !
Status,, 
=,, 
$num,, 
,,, 
CreationDate-- 
=-- 
DateTime-- #
.--# $
UtcNow--$ *
,--* +
ModificationDate.. 
=.. 
DateTime.. '
...' (
UtcNow..( .
,... /
}// 	
;//	 

await11 
_context11 
.11 
Users11 
.11 
AddAsync11 %
(11% &
newUser11& -
)11- .
;11. /
await22 
_context22 
.22 
SaveChangesAsync22 '
(22' (
)22( )
;22) *
return44 
Ok44 
(44 
newUser44 
)44 
;44 
}55 
[77 

HttpDelete77 
(77 
$str77 
)77 
]77 
public88 

async88 
Task88 
<88 
IActionResult88 #
>88# $
DeactivateUser88% 3
(883 4
short884 9
id88: <
,88< =
[88> ?

FromHeader88? I
]88I J
string88K Q
userRole88R Z
)88Z [
{99 
if:: 

(:: 
userRole:: 
!=:: 
	AdminRole:: !
)::! "
return;; 
Forbid;; 
(;; 
$str;; M
);;M N
;;;N O
var== 
user== 
=== 
await== 
_context== !
.==! "
Users==" '
.==' (
	FindAsync==( 1
(==1 2
id==2 4
)==4 5
;==5 6
if>> 

(>> 
user>> 
==>> 
null>> 
)>> 
return>>  
NotFound>>! )
(>>) *
$str>>* B
)>>B C
;>>C D
user@@ 
.@@ 
Status@@ 
=@@ 
$num@@ 
;@@ 
userAA 
.AA 
ModificationDateAA 
=AA 
DateTimeAA  (
.AA( )
UtcNowAA) /
;AA/ 0
_contextCC 
.CC 
UsersCC 
.CC 
UpdateCC 
(CC 
userCC "
)CC" #
;CC# $
awaitDD 
_contextDD 
.DD 
SaveChangesAsyncDD '
(DD' (
)DD( )
;DD) *
returnFF 
OkFF 
(FF 
$strFF 7
)FF7 8
;FF8 9
}GG 
[JJ 
HttpPutJJ 
(JJ 
$strJJ 
)JJ 
]JJ 
publicKK 

asyncKK 
TaskKK 
<KK 
IActionResultKK #
>KK# $

UpdateUserKK% /
(KK/ 0
shortKK0 5
idKK6 8
,KK8 9
[KK: ;
FromBodyKK; C
]KKC D
CreateUserDtoKKE R
userDtoKKS Z
,KKZ [
[KK\ ]

FromHeaderKK] g
]KKg h
stringKKi o
userRoleKKp x
)KKx y
{LL 
ifMM 

(MM 
userRoleMM 
!=MM 
	AdminRoleMM !
)MM! "
returnNN 
ForbidNN 
(NN 
$strNN L
)NNL M
;NNM N
ifPP 

(PP 
userDtoPP 
==PP 
nullPP 
)PP 
returnQQ 

BadRequestQQ 
(QQ 
$strQQ E
)QQE F
;QQF G
ifSS 

(SS 
!SS 

ModelStateSS 
.SS 
IsValidSS 
)SS  
returnTT 

BadRequestTT 
(TT 

ModelStateTT (
)TT( )
;TT) *
varVV 
userVV 
=VV 
awaitVV 
_contextVV !
.VV! "
UsersVV" '
.VV' (
	FindAsyncVV( 1
(VV1 2
idVV2 4
)VV4 5
;VV5 6
ifWW 

(WW 
userWW 
==WW 
nullWW 
)WW 
returnWW  
NotFoundWW! )
(WW) *
$strWW* B
)WWB C
;WWC D
userZZ 
.ZZ 
UsernameZZ 
=ZZ 
userDtoZZ 
.ZZ  
UsernameZZ  (
;ZZ( )
user[[ 
.[[ 
	FirstName[[ 
=[[ 
userDto[[  
.[[  !
	FirstName[[! *
;[[* +
user\\ 
.\\ 
LastName\\ 
=\\ 
userDto\\ 
.\\  
LastName\\  (
;\\( )
user]] 
.]] 
SecondLastName]] 
=]] 
userDto]] %
.]]% &
SecondLastName]]& 4
;]]4 5
user^^ 
.^^ 
Role^^ 
=^^ 
userDto^^ 
.^^ 
Role^^  
;^^  !
user__ 
.__ 
ModificationDate__ 
=__ 
DateTime__  (
.__( )
UtcNow__) /
;__/ 0
_contextaa 
.aa 
Usersaa 
.aa 
Updateaa 
(aa 
useraa "
)aa" #
;aa# $
awaitbb 
_contextbb 
.bb 
SaveChangesAsyncbb '
(bb' (
)bb( )
;bb) *
returndd 
Okdd 
(dd 
userdd 
)dd 
;dd 
}ee 
[gg 
HttpPutgg 
(gg 
$strgg 
)gg 
]gg 
publichh 

asynchh 
Taskhh 
<hh 
IActionResulthh #
>hh# $
UpdateUserRolehh% 3
(hh3 4
shorthh4 9
idhh: <
,hh< =
[hh> ?
FromBodyhh? G
]hhG H
stringhhI O
newRolehhP W
)hhW X
{ii 
varjj 
userRolejj 
=jj 
Requestjj 
.jj 
Cookiesjj &
[jj& '
$strjj' 1
]jj1 2
;jj2 3
ifkk 

(kk 
userRolekk 
!=kk 
	AdminRolekk !
)kk! "
returnkk# )
Forbidkk* 0
(kk0 1
$strkk1 ]
)kk] ^
;kk^ _
varmm 
usermm 
=mm 
awaitmm 
_contextmm !
.mm! "
Usersmm" '
.mm' (
	FindAsyncmm( 1
(mm1 2
idmm2 4
)mm4 5
;mm5 6
ifnn 

(nn 
usernn 
==nn 
nullnn 
)nn 
returnnn  
NotFoundnn! )
(nn) *
$strnn* B
)nnB C
;nnC D
userpp 
.pp 
Rolepp 
=pp 
newRolepp 
;pp 
userqq 
.qq 
ModificationDateqq 
=qq 
DateTimeqq  (
.qq( )
UtcNowqq) /
;qq/ 0
_contextss 
.ss 
Usersss 
.ss 
Updatess 
(ss 
userss "
)ss" #
;ss# $
awaittt 
_contexttt 
.tt 
SaveChangesAsynctt '
(tt' (
)tt( )
;tt) *
returnvv 
Okvv 
(vv 
uservv 
)vv 
;vv 
}ww 
[zz 
HttpGetzz 
]zz 
public{{ 

async{{ 
Task{{ 
<{{ 
IActionResult{{ #
>{{# $
GetAllUsers{{% 0
({{0 1
){{1 2
{|| 
var}} 
users}} 
=}} 
await}} 
_context}} "
.}}" #
Users}}# (
.}}( )
ToListAsync}}) 4
(}}4 5
)}}5 6
;}}6 7
return~~ 
Ok~~ 
(~~ 
users~~ 
)~~ 
;~~ 
} 
}€€ ”Q
ƒC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Controllers\SuppliersController.cs
	namespace 	
InventoryManagement
 
. 
Controllers )
;) *
[		 
ApiController		 
]		 
[

 
Route

 
(

 
$str

 
)

 
]

 
public 
class 
SuppliersController  
:! "
ControllerBase# 1
{ 
private 
readonly 
ISupplierRepository (
_supplierRepository) <
;< =
private 
const 
string #
SupplierNotFoundMessage 0
=1 2
$str3 M
;M N
public 

SuppliersController 
( 
ISupplierRepository 2
supplierRepository3 E
)E F
{ 
_supplierRepository 
= 
supplierRepository 0
;0 1
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $
GetAllSuppliers% 4
(4 5
)5 6
{ 
var 
	suppliers 
= 
await 
_supplierRepository 1
.1 2
GetAllAsync2 =
(= >
)> ?
;? @
return 
Ok 
( 
	suppliers 
) 
; 
} 
[ 
HttpGet 
( 
$str 
) 
] 
public   

async   
Task   
<   
IActionResult   #
>  # $
GetSupplierById  % 4
(  4 5
short  5 :
id  ; =
)  = >
{!! 
var"" 
supplier"" 
="" 
await"" 
_supplierRepository"" 0
.""0 1
GetByIdAsync""1 =
(""= >
id""> @
)""@ A
;""A B
if## 

(## 
supplier## 
==## 
null## 
||## 
supplier##  (
.##( )
Status##) /
==##0 2
$num##3 4
)##4 5
{$$ 	
return%% 
NotFound%% 
(%% #
SupplierNotFoundMessage%% 3
)%%3 4
;%%4 5
}&& 	
return'' 
Ok'' 
('' 
supplier'' 
)'' 
;'' 
}(( 
[++ 
HttpPost++ 
]++ 
public,, 

async,, 
Task,, 
<,, 
IActionResult,, #
>,,# $
CreateSupplier,,% 3
(,,3 4
[,,4 5
FromBody,,5 =
],,= >
CreateSupplierDto,,? P
supplierDto,,Q \
,,,\ ]
[,,^ _

FromHeader,,_ i
],,i j
short,,k p
userId,,q w
),,w x
{-- 
var.. 
newSupplier.. 
=.. 
new.. 
Supplier.. &
{// 	
Name00 
=00 
supplierDto00 
.00 
Name00 #
,00# $
Nit11 
=11 
supplierDto11 
.11 
Nit11 !
,11! "
Address22 
=22 
supplierDto22 !
.22! "
Address22" )
,22) *
Phone33 
=33 
supplierDto33 
.33  
Phone33  %
,33% &
Email44 
=44 
supplierDto44 
.44  
Email44  %
,44% &
ContactName55 
=55 
supplierDto55 %
.55% &
ContactName55& 1
,551 2
Status66 
=66 
$num66 
,66 
CreationDate77 
=77 
DateTime77 #
.77# $
UtcNow77$ *
,77* +
ModificationDate88 
=88 
DateTime88 '
.88' (
UtcNow88( .
,88. /
CreatedByUserId99 
=99 
userId99 $
}:: 	
;::	 

await<< 
_supplierRepository<< !
.<<! "
AddAsync<<" *
(<<* +
newSupplier<<+ 6
)<<6 7
;<<7 8
return== 
CreatedAtAction== 
(== 
nameof== %
(==% &
GetSupplierById==& 5
)==5 6
,==6 7
new==8 ;
{==< =
id==> @
===A B
newSupplier==C N
.==N O
Id==O Q
}==R S
,==S T
newSupplier==U `
)==` a
;==a b
}>> 
[AA 
HttpPutAA 
(AA 
$strAA 
)AA 
]AA 
publicBB 

asyncBB 
TaskBB 
<BB 
IActionResultBB #
>BB# $
UpdateSupplierBB% 3
(BB3 4
shortBB4 9
idBB: <
,BB< =
[BB> ?
FromBodyBB? G
]BBG H
UpdateSupplierDtoBBI Z
supplierDtoBB[ f
)BBf g
{CC 
varDD 
supplierDD 
=DD 
awaitDD 
_supplierRepositoryDD 0
.DD0 1
GetByIdAsyncDD1 =
(DD= >
idDD> @
)DD@ A
;DDA B
ifEE 

(EE 
supplierEE 
==EE 
nullEE 
||EE 
supplierEE  (
.EE( )
StatusEE) /
==EE0 2
$numEE3 4
)EE4 5
{FF 	
returnGG 
NotFoundGG 
(GG #
SupplierNotFoundMessageGG 3
)GG3 4
;GG4 5
}HH 	
supplierJJ 
.JJ 
NameJJ 
=JJ 
supplierDtoJJ #
.JJ# $
NameJJ$ (
;JJ( )
supplierKK 
.KK 
NitKK 
=KK 
supplierDtoKK "
.KK" #
NitKK# &
;KK& '
supplierLL 
.LL 
AddressLL 
=LL 
supplierDtoLL &
.LL& '
AddressLL' .
;LL. /
supplierMM 
.MM 
PhoneMM 
=MM 
supplierDtoMM $
.MM$ %
PhoneMM% *
;MM* +
supplierNN 
.NN 
EmailNN 
=NN 
supplierDtoNN $
.NN$ %
EmailNN% *
;NN* +
supplierOO 
.OO 
ContactNameOO 
=OO 
supplierDtoOO *
.OO* +
ContactNameOO+ 6
;OO6 7
supplierPP 
.PP 
ModificationDatePP !
=PP" #
DateTimePP$ ,
.PP, -
UtcNowPP- 3
;PP3 4
awaitRR 
_supplierRepositoryRR !
.RR! "
UpdateAsyncRR" -
(RR- .
supplierRR. 6
)RR6 7
;RR7 8
returnSS 
OkSS 
(SS 
supplierSS 
)SS 
;SS 
}TT 
[WW 

HttpDeleteWW 
(WW 
$strWW 
)WW 
]WW 
publicXX 

asyncXX 
TaskXX 
<XX 
IActionResultXX #
>XX# $
DeactivateSupplierXX% 7
(XX7 8
shortXX8 =
idXX> @
,XX@ A
[XXB C

FromHeaderXXC M
]XXM N
stringXXO U
userRoleXXV ^
)XX^ _
{YY 
ifZZ 

(ZZ 
userRoleZZ 
!=ZZ 
$strZZ 
)ZZ  
{[[ 	
return\\ 
Forbid\\ 
(\\ 
$str\\ o
)\\o p
;\\p q
}]] 	
var__ 
supplier__ 
=__ 
await__ 
_supplierRepository__ 0
.__0 1
GetByIdAsync__1 =
(__= >
id__> @
)__@ A
;__A B
if`` 

(`` 
supplier`` 
==`` 
null`` 
)`` 
{aa 	
returnbb 
NotFoundbb 
(bb #
SupplierNotFoundMessagebb 3
)bb3 4
;bb4 5
}cc 	
supplieree 
.ee 
Statusee 
=ee 
$numee 
;ee 
supplierff 
.ff 
ModificationDateff !
=ff" #
DateTimeff$ ,
.ff, -
UtcNowff- 3
;ff3 4
awaithh 
_supplierRepositoryhh !
.hh! "
UpdateAsynchh" -
(hh- .
supplierhh. 6
)hh6 7
;hh7 8
returnii 
Okii 
(ii 
$strii 9
)ii9 :
;ii: ;
}jj 
[ll 
HttpPutll 
(ll 
$strll 
)ll 
]ll 
publicmm 

asyncmm 
Taskmm 
<mm 
IActionResultmm #
>mm# $
ActivateSuppliermm% 5
(mm5 6
shortmm6 ;
idmm< >
,mm> ?
[mm@ A

FromHeadermmA K
]mmK L
stringmmM S
userRolemmT \
)mm\ ]
{nn 
ifoo 

(oo 
userRoleoo 
!=oo 
$stroo 
)oo  
returnpp 
Forbidpp 
(pp 
$strpp R
)ppR S
;ppS T
varrr 
supplierrr 
=rr 
awaitrr 
_supplierRepositoryrr 0
.rr0 1
GetByIdAsyncrr1 =
(rr= >
idrr> @
)rr@ A
;rrA B
ifss 

(ss 
supplierss 
==ss 
nullss 
)ss 
returntt 
NotFoundtt 
(tt #
SupplierNotFoundMessagett 3
)tt3 4
;tt4 5
suppliervv 
.vv 
Statusvv 
=vv 
$numvv 
;vv 
supplierww 
.ww 
ModificationDateww !
=ww" #
DateTimeww$ ,
.ww, -
UtcNowww- 3
;ww3 4
awaityy 
_supplierRepositoryyy !
.yy! "
UpdateAsyncyy" -
(yy- .
supplieryy. 6
)yy6 7
;yy7 8
returnzz 
Okzz 
(zz 
$strzz 7
)zz7 8
;zz8 9
}{{ 
}}} Ä/
ˆC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Controllers\PurchaseDetailController.cs
	namespace 	
InventoryManagement
 
. 
Controllers )
;) *
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public		 
class		 %
PurchaseDetailsController		 &
:		' (
ControllerBase		) 7
{

 
private 
readonly %
IPurchaseDetailRepository .%
_purchaseDetailRepository/ H
;H I
public 
%
PurchaseDetailsController $
($ %%
IPurchaseDetailRepository% >$
purchaseDetailRepository? W
)W X
{ %
_purchaseDetailRepository !
=" #$
purchaseDetailRepository$ <
;< =
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $!
GetAllPurchaseDetails% :
(: ;
[; <

FromHeader< F
]F G
stringH N
userRoleO W
)W X
{ 
if 

( 
userRole 
!= 
$str 
)  
{ 	
return 
Forbid 
( 
$str h
)h i
;i j
} 	
var 
details 
= 
await %
_purchaseDetailRepository 5
.5 6
GetAllAsync6 A
(A B
)B C
;C D
return 
Ok 
( 
details 
) 
; 
} 
[   
HttpGet   
(   
$str   $
)  $ %
]  % &
public!! 

async!! 
Task!! 
<!! 
IActionResult!! #
>!!# $"
GetDetailsByPurchaseId!!% ;
(!!; <
int!!< ?

purchaseId!!@ J
)!!J K
{"" 
var## 
details## 
=## 
await## %
_purchaseDetailRepository## 5
.##5 6 
GetByPurchaseIdAsync##6 J
(##J K

purchaseId##K U
)##U V
;##V W
if%% 

(%% 
details%% 
==%% 
null%% 
||%% 
details%% &
.%%& '
Count%%' ,
==%%- /
$num%%0 1
)%%1 2
{&& 	
return'' 
NotFound'' 
('' 
$str'' J
)''J K
;''K L
}(( 	
return** 
Ok** 
(** 
details** 
)** 
;** 
}++ 
[.. 
HttpPost.. 
].. 
public// 

async// 
Task// 
<// 
IActionResult// #
>//# $
AddPurchaseDetail//% 6
(//6 7
[00 	
FromBody00	 
]00 
PurchaseDetail00 !
purchaseDetail00" 0
,000 1
[11 	

FromHeader11	 
]11 
string11 
userRole11 $
)11$ %
{22 
if33 

(33 
userRole33 
!=33 
$str33 
)33  
{44 	
return55 
Forbid55 
(55 
$str55 b
)55b c
;55c d
}66 	
try88 
{99 	
await:: %
_purchaseDetailRepository:: +
.::+ ,
AddAsync::, 4
(::4 5
purchaseDetail::5 C
)::C D
;::D E
return;; 
Ok;; 
(;; 
new;; 
{;; 
message;; #
=;;$ %
$str;;& E
,;;E F
purchaseDetail;;G U
};;V W
);;W X
;;;X Y
}<< 	
catch== 
(== 
	Exception== 
ex== 
)== 
{>> 	
return?? 

StatusCode?? 
(?? 
$num?? !
,??! "
new??# &
{??' (
error??) .
=??/ 0
$str??1 K
,??K L
details??M T
=??U V
ex??W Y
.??Y Z
Message??Z a
}??b c
)??c d
;??d e
}@@ 	
}AA 
[DD 
HttpPutDD 
]DD 
publicEE 

asyncEE 
TaskEE 
<EE 
IActionResultEE #
>EE# $ 
UpdatePurchaseDetailEE% 9
(EE9 :
[FF 	
FromBodyFF	 
]FF 
PurchaseDetailFF !
purchaseDetailFF" 0
,FF0 1
[GG 	

FromHeaderGG	 
]GG 
stringGG 
userRoleGG $
)GG$ %
{HH 
ifII 

(II 
userRoleII 
!=II 
$strII 
)II  
{JJ 	
returnKK 
ForbidKK 
(KK 
$strKK e
)KKe f
;KKf g
}LL 	
tryNN 
{OO 	
awaitPP %
_purchaseDetailRepositoryPP +
.PP+ ,
UpdateAsyncPP, 7
(PP7 8
purchaseDetailPP8 F
)PPF G
;PPG H
returnQQ 
OkQQ 
(QQ 
newQQ 
{QQ 
messageQQ #
=QQ$ %
$strQQ& H
,QQH I
purchaseDetailQQJ X
}QQY Z
)QQZ [
;QQ[ \
}RR 	
catchSS 
(SS 
	ExceptionSS 
exSS 
)SS 
{TT 	
returnUU 

StatusCodeUU 
(UU 
$numUU !
,UU! "
newUU# &
{UU' (
errorUU) .
=UU/ 0
$strUU1 N
,UUN O
detailsUUP W
=UUX Y
exUUZ \
.UU\ ]
MessageUU] d
}UUe f
)UUf g
;UUg h
}VV 	
}WW 
}XX êU
‚C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Controllers\PurchaseController.cs
	namespace 	
InventoryManagement
 
. 
Controllers )
;) *
[ 
ApiController 
] 
[		 
Route		 
(		 
$str		 
)		 
]		 
public

 
class

 
PurchasesController

  
:

! "
ControllerBase

# 1
{ 
private 
readonly 
IPurchaseRepository (
_purchaseRepository) <
;< =
public 

PurchasesController 
( 
IPurchaseRepository 2
purchaseRepository3 E
)E F
{ 
_purchaseRepository 
= 
purchaseRepository 0
;0 1
} 
[ 
HttpPost 
] 
public 

async 
Task 
< 
IActionResult #
># $
CreatePurchase% 3
(3 4
[ 	
FromBody	 
] 
CreatePurchaseDto $
purchaseDto% 0
,0 1
[ 	

FromHeader	 
] 
short 
userId !
)! "
{ 
try 
{ 	
await 
_purchaseRepository %
.% &
AddAsync& .
(. /
purchaseDto/ :
,: ;
userId< B
)B C
;C D
return 
Ok 
( 
new 
{ 
message #
=$ %
$str& F
}G H
)H I
;I J
} 	
catch 
( %
InvalidOperationException (
ex) +
)+ ,
{ 	
return   

BadRequest   
(   
new   !
{  " #
error  $ )
=  * +
ex  , .
.  . /
Message  / 6
}  7 8
)  8 9
;  9 :
}!! 	
catch"" 
("" 
	Exception"" 
ex"" 
)"" 
{## 	
return$$ 

StatusCode$$ 
($$ 
$num$$ !
,$$! "
new$$# &
{$$' (
error$$) .
=$$/ 0
$str$$1 M
,$$M N
details$$O V
=$$W X
ex$$Y [
.$$[ \
Message$$\ c
}$$d e
)$$e f
;$$f g
}%% 	
}&& 
[)) 
HttpGet)) 
])) 
public** 

async** 
Task** 
<** 
IActionResult** #
>**# $
GetAllPurchases**% 4
(**4 5
[**5 6

FromHeader**6 @
]**@ A
string**B H
userRole**I Q
)**Q R
{++ 
if,, 

(,, 
userRole,, 
!=,, 
$str,, 
),,  
{-- 	
return.. 
Forbid.. 
(.. 
$str.. g
)..g h
;..h i
}// 	
var11 
	purchases11 
=11 
await11 
_purchaseRepository11 1
.111 2
GetAllAsync112 =
(11= >
)11> ?
;11? @
var22 
response22 
=22 "
MapPurchasesToResponse22 -
(22- .
	purchases22. 7
)227 8
;228 9
return33 
Ok33 
(33 
response33 
)33 
;33 
}44 
[77 
HttpGet77 
(77 
$str77 
)77 
]77 
public88 

async88 
Task88 
<88 
IActionResult88 #
>88# $
GetUserPurchases88% 5
(885 6
[886 7

FromHeader887 A
]88A B
short88C H
userId88I O
)88O P
{99 
var:: 
	purchases:: 
=:: 
await:: 
_purchaseRepository:: 1
.::1 2
GetByUserIdAsync::2 B
(::B C
userId::C I
)::I J
;::J K
var;; 
response;; 
=;; "
MapPurchasesToResponse;; -
(;;- .
	purchases;;. 7
);;7 8
;;;8 9
return<< 
Ok<< 
(<< 
response<< 
)<< 
;<< 
}== 
[@@ 
HttpGet@@ 
(@@ 
$str@@ 
)@@ 
]@@ 
publicAA 

asyncAA 
TaskAA 
<AA 
IActionResultAA #
>AA# $
GetPurchaseByIdAA% 4
(AA4 5
intAA5 8
idAA9 ;
,AA; <
[AA= >

FromHeaderAA> H
]AAH I
shortAAJ O
userIdAAP V
,AAV W
[AAX Y

FromHeaderAAY c
]AAc d
stringAAe k
userRoleAAl t
)AAt u
{BB 
varCC 
purchaseCC 
=CC 
awaitCC 
_purchaseRepositoryCC 0
.CC0 1
GetByIdAsyncCC1 =
(CC= >
idCC> @
)CC@ A
;CCA B
ifEE 

(EE 
purchaseEE 
==EE 
nullEE 
)EE 
{FF 	
returnGG 
NotFoundGG 
(GG 
$strGG 3
)GG3 4
;GG4 5
}HH 	
ifKK 

(KK 
userRoleKK 
!=KK 
$strKK 
&&KK  "
purchaseKK# +
.KK+ ,
CreatedByUserIdKK, ;
!=KK< >
userIdKK? E
)KKE F
{LL 	
returnMM 
ForbidMM 
(MM 
$strMM C
)MMC D
;MMD E
}NN 	
varPP 
responsePP 
=PP !
MapPurchaseToResponsePP ,
(PP, -
purchasePP- 5
)PP5 6
;PP6 7
returnQQ 
OkQQ 
(QQ 
responseQQ 
)QQ 
;QQ 
}RR 
[UU 
HttpPutUU 
(UU 
$strUU 
)UU 
]UU 
publicVV 

asyncVV 
TaskVV 
<VV 
IActionResultVV #
>VV# $
UpdatePurchaseVV% 3
(VV3 4
intVV4 7
idVV8 :
,VV: ;
[VV< =

FromHeaderVV= G
]VVG H
stringVVI O
userRoleVVP X
)VVX Y
{WW 
ifXX 

(XX 
userRoleXX 
!=XX 
$strXX 
)XX  
{YY 	
returnZZ 
ForbidZZ 
(ZZ 
$strZZ d
)ZZd e
;ZZe f
}[[ 	
var]] 
purchase]] 
=]] 
await]] 
_purchaseRepository]] 0
.]]0 1
GetByIdAsync]]1 =
(]]= >
id]]> @
)]]@ A
;]]A B
if^^ 

(^^ 
purchase^^ 
==^^ 
null^^ 
)^^ 
{__ 	
return`` 
NotFound`` 
(`` 
$str`` 3
)``3 4
;``4 5
}aa 	
trycc 
{dd 	
awaitee 
_purchaseRepositoryee %
.ee% &
UpdateAsyncee& 1
(ee1 2
purchaseee2 :
)ee: ;
;ee; <
returnff 
Okff 
(ff 
newff 
{ff 
messageff #
=ff$ %
$strff& G
,ffG H
purchaseffI Q
}ffR S
)ffS T
;ffT U
}gg 	
catchhh 
(hh 
	Exceptionhh 
exhh 
)hh 
{ii 	
returnjj 

StatusCodejj 
(jj 
$numjj !
,jj! "
newjj# &
{jj' (
errorjj) .
=jj/ 0
$strjj1 P
,jjP Q
detailsjjR Y
=jjZ [
exjj\ ^
.jj^ _
Messagejj_ f
}jjg h
)jjh i
;jji j
}kk 	
}ll 
privateoo 
staticoo 
Listoo 
<oo 
PurchaseResponseDtooo +
>oo+ ,"
MapPurchasesToResponseoo- C
(ooC D
ListooD H
<ooH I
DomainooI O
.ooO P
EntitiesooP X
.ooX Y
PurchaseooY a
>ooa b
	purchasesooc l
)ool m
{pp 
returnqq 
	purchasesqq 
.qq 
Selectqq 
(qq  
pqq  !
=>qq" $!
MapPurchaseToResponseqq% :
(qq: ;
pqq; <
)qq< =
)qq= >
.qq> ?
ToListqq? E
(qqE F
)qqF G
;qqG H
}rr 
privateuu 
staticuu 
PurchaseResponseDtouu &!
MapPurchaseToResponseuu' <
(uu< =
Domainuu= C
.uuC D
EntitiesuuD L
.uuL M
PurchaseuuM U
purchaseuuV ^
)uu^ _
{vv 
returnww 
newww 
PurchaseResponseDtoww &
{xx 	
Idyy 
=yy 
purchaseyy 
.yy 
Idyy 
,yy 
Fechazz 
=zz 
purchasezz 
.zz 
CreationDatezz )
.zz) *
ToStringzz* 2
(zz2 3
$strzz3 ?
)zz? @
,zz@ A
	Proveedor{{ 
={{ 
purchase{{  
.{{  !
Supplier{{! )
?{{) *
.{{* +
Name{{+ /
??{{0 2
$str{{3 B
,{{B C
Total|| 
=|| 
$"|| 
{|| 
purchase|| 
.||  
TotalPurchase||  -
:||- .
$str||. 0
}||0 1
$str||1 5
"||5 6
,||6 7
Expanded}} 
=}} 
false}} 
,}} 
Detalles~~ 
=~~ 
purchase~~ 
.~~  
PurchaseDetails~~  /
?~~/ 0
.~~0 1
Select~~1 7
(~~7 8
pd~~8 :
=>~~; =
new~~> A%
PurchaseDetailResponseDto~~B [
{ 
Producto
€€ 
=
€€ 
pd
€€ 
.
€€ 
Product
€€ %
?
€€% &
.
€€& '
Name
€€' +
??
€€, .
$str
€€/ ;
,
€€; <
Cantidad
 
=
 
pd
 
.
 
Quantity
 &
,
& '
PrecioUnitario
‚‚ 
=
‚‚  
pd
‚‚! #
.
‚‚# $
	UnitPrice
‚‚$ -
}
ƒƒ 
)
ƒƒ 
.
ƒƒ 
ToList
ƒƒ 
(
ƒƒ 
)
ƒƒ 
??
ƒƒ 
new
ƒƒ 
List
ƒƒ #
<
ƒƒ# $'
PurchaseDetailResponseDto
ƒƒ$ =
>
ƒƒ= >
(
ƒƒ> ?
)
ƒƒ? @
}
„„ 	
;
„„	 

}
…… 
}†† ·
‚C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Controllers\ProductsController.cs
	namespace 	
InventoryManagement
 
. 
Controllers )
;) *
[		 
ApiController		 
]		 
[

 
Route

 
(

 
$str

 
)

 
]

 
public 
class 
ProductsController 
:  !
ControllerBase" 0
{ 
private 
readonly 
IProductRepository '
_productRepository( :
;: ;
public 

ProductsController 
( 
IProductRepository 0
productRepository1 B
)B C
{ 
_productRepository 
= 
productRepository .
;. /
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $
GetAllProducts% 3
(3 4
)4 5
{ 
var 
products 
= 
await 
_productRepository /
./ 0
GetAllAsync0 ;
(; <
)< =
;= >
return 
Ok 
( 
products 
) 
; 
} 
[ 
HttpPost 
] 
public 

async 
Task 
< 
IActionResult #
># $
CreateProduct% 2
(2 3
[3 4
FromBody4 <
]< =
CreateProductDto> N

productDtoO Y
,Y Z
[[ \

FromHeader\ f
]f g
shorth m
userIdn t
)t u
{ 
var   

newProduct   
=   
new   
Product   $
{!! 	
Id"" 
="" 

productDto"" 
."" 
Id"" 
,"" 
Name## 
=## 

productDto## 
.## 
Name## "
,##" #
Description$$ 
=$$ 

productDto$$ $
.$$$ %
Description$$% 0
,$$0 1

CategoryId%% 
=%% 

productDto%% #
.%%# $

CategoryId%%$ .
,%%. /

TotalStock&& 
=&& 

productDto&& #
.&&# $

TotalStock&&$ .
,&&. /
Status'' 
='' 
$num'' 
,'' 
CreationDate(( 
=(( 
DateTime(( #
.((# $
UtcNow(($ *
,((* +
ModificationDate)) 
=)) 
DateTime)) '
.))' (
UtcNow))( .
,)). /
CreatedByUserId** 
=** 
userId** $
}++ 	
;++	 

await-- 
_productRepository--  
.--  !
AddAsync--! )
(--) *

newProduct--* 4
)--4 5
;--5 6
return.. 
Ok.. 
(.. 

newProduct.. 
).. 
;.. 
}// 
}00 ¯
‚C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Controllers\CategoryController.cs
	namespace 	
InventoryManagement
 
. 
Controllers )
;) *
[ 
ApiController 
] 
[		 
Route		 
(		 
$str		 
)		 
]		 
public

 
class

  
CategoriesController

 !
:

" #
ControllerBase

$ 2
{ 
private 
readonly 
ICategoryRepository (
_categoryRepository) <
;< =
public 
 
CategoriesController 
(  
ICategoryRepository  3
categoryRepository4 F
)F G
{ 
_categoryRepository 
= 
categoryRepository 0
;0 1
} 
[ 
HttpPost 
] 
public 

async 
Task 
< 
IActionResult #
># $
CreateCategory% 3
(3 4
[4 5
FromBody5 =
]= >
CreateCategoryDto? P
categoryDtoQ \
,\ ]
[] ^

FromHeader^ h
]h i
shortj o
userIdp v
)v w
{ 
var 
newCategory 
= 
new 
Category &
{ 	
Name 
= 
categoryDto 
. 
Name #
,# $
Description 
= 
categoryDto %
.% &
Description& 1
,1 2
Status 
= 
$num 
, 
CreationDate 
= 
DateTime #
.# $
UtcNow$ *
,* +
ModificationDate 
= 
DateTime '
.' (
UtcNow( .
,. /
CreatedByUserId 
= 
userId $
} 	
;	 

await!! 
_categoryRepository!! !
.!!! "
AddAsync!!" *
(!!* +
newCategory!!+ 6
)!!6 7
;!!7 8
return## 
Ok## 
(## 
newCategory## 
)## 
;## 
}$$ 
[&& 
HttpGet&& 
]&& 
public'' 

async'' 
Task'' 
<'' 
IActionResult'' #
>''# $
GetAllCategories''% 5
(''5 6
)''6 7
{(( 
var)) 

categories)) 
=)) 
await)) 
_categoryRepository)) 2
.))2 3
GetAllAsync))3 >
())> ?
)))? @
;))@ A
var** 
activeCategories** 
=** 

categories** )
.**) *
ToList*** 0
(**0 1
)**1 2
;**2 3
return,, 
Ok,, 
(,, 
activeCategories,, "
),," #
;,,# $
}-- 
}.. ª!
~C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Controllers\AuthController.cs
	namespace 	
InventoryManagement
 
. 
Controllers )
{ 
[ 
ApiController 
] 
[		 
Route		 

(		
 
$str		 
)		 
]		 
public

 

class

 
AuthController

 
:

  !
ControllerBase

" 0
{ 
private 
readonly 
IUserRepository (
_userRepository) 8
;8 9
public 
AuthController 
( 
IUserRepository -
userRepository. <
)< =
{ 	
_userRepository 
= 
userRepository ,
;, -
} 	
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
Login) .
(. /
[/ 0
FromBody0 8
]8 9
InventoryManagement: M
.M N
ApplicationN Y
.Y Z
DTOsZ ^
.^ _
LoginDto_ g
loginDtoh p
)p q
{ 	
if 
( 
loginDto 
== 
null  
||! #
string$ *
.* +
IsNullOrEmpty+ 8
(8 9
loginDto9 A
.A B
UsernameB J
)J K
||L N
stringO U
.U V
IsNullOrEmptyV c
(c d
loginDtod l
.l m
Passwordm u
)u v
)v w
{ 
return 

BadRequest !
(! "
$str" D
)D E
;E F
} 
var 
user 
= 
await 
_userRepository ,
., -
GetByUsernameAsync- ?
(? @
loginDto@ H
.H I
UsernameI Q
)Q R
;R S
if 
( 
user 
== 
null 
) 
{ 
return   
Unauthorized   #
(  # $
$str  $ <
)  < =
;  = >
}!! 
if%% 
(%% 
user%% 
.%% 
PasswordHash%% !
!=%%" $
loginDto%%% -
.%%- .
Password%%. 6
)%%6 7
{&& 
return'' 
Unauthorized'' #
(''# $
$str''$ =
)''= >
;''> ?
}(( 
Response** 
.** 
Cookies** 
.** 
Append** #
(**# $
$str**$ ,
,**, -
user**. 2
.**2 3
Id**3 5
.**5 6
ToString**6 >
(**> ?
)**? @
,**@ A
new**B E
CookieOptions**F S
{**T U
HttpOnly**V ^
=**_ `
true**a e
,**e f
Secure**g m
=**n o
true**p t
}**u v
)**v w
;**w x
Response++ 
.++ 
Cookies++ 
.++ 
Append++ #
(++# $
$str++$ .
,++. /
user++0 4
.++4 5
Role++5 9
,++9 :
new++; >
CookieOptions++? L
{++M N
HttpOnly++O W
=++X Y
true++Z ^
,++^ _
Secure++` f
=++g h
true++i m
}++n o
)++o p
;++p q
var.. 
response.. 
=.. 
new.. 
LoginResponseDto.. /
{// 
Id00 
=00 
user00 
.00 
Id00 
,00 
Username11 
=11 
user11 
.11  
Username11  (
,11( )
Role22 
=22 
user22 
.22 
Role22  
}33 
;33 
return55 
Ok55 
(55 
response55 
)55 
;55  
}66 	
}77 
}88 ¾	
ŠC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\Interfaces\IUserRepository.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *

Interfaces* 4
;4 5
public 
	interface 
IUserRepository  
{ 
Task 
< 	
User	 
? 
> 
GetByUsernameAsync "
(" #
string# )
username* 2
)2 3
;3 4
Task 
AddUserAsync	 
( 
User 
user 
)  
;  !
Task 
UpdateUserAsync	 
( 
User 
user "
)" #
;# $
Task 
< 	
List	 
< 
User 
> 
> 
GetAllUsersAsync %
(% &
)& '
;' (
Task		 
<		 	
User			 
?		 
>		 
GetByIdAsync		 
(		 
short		 "
id		# %
)		% &
;		& '
}

 ‰
ŽC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\Interfaces\ISupplierRepository.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *

Interfaces* 4
;4 5
public 
	interface 
ISupplierRepository $
{ 
Task 
< 	
Supplier	 
? 
> 
GetByIdAsync  
(  !
short! &
id' )
)) *
;* +
Task 
< 	
List	 
< 
Supplier 
> 
> 
GetAllAsync $
($ %
)% &
;& '
Task		 
AddAsync			 
(		 
Supplier		 
supplier		 #
)		# $
;		$ %
Task

 
UpdateAsync

	 
(

 
Supplier

 
supplier

 &
)

& '
;

' (
} ±

ŽC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\Interfaces\IPurchaseRepository.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *

Interfaces* 4
;4 5
public 
	interface 
IPurchaseRepository $
{ 
Task 
AddAsync	 
( 
CreatePurchaseDto #
dto$ '
,' (
short) .
userId/ 5
)5 6
;6 7
Task 
< 	
List	 
< 
Purchase 
> 
> 
GetAllAsync $
($ %
)% &
;& '
Task		 
<		 	
List			 
<		 
Purchase		 
>		 
>		 
GetByUserIdAsync		 )
(		) *
short		* /
userId		0 6
)		6 7
;		7 8
Task

 
<

 	
Purchase

	 
?

 
>

 
GetByIdAsync

  
(

  !
int

! $

purchaseId

% /
)

/ 0
;

0 1
Task 
UpdateAsync	 
( 
Purchase 
purchase &
)& '
;' (
} è
”C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\Interfaces\IPurchaseDetailRepository.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *

Interfaces* 4
;4 5
public 
	interface %
IPurchaseDetailRepository *
{ 
Task 
< 	
List	 
< 
PurchaseDetail 
> 
> 
GetAllAsync *
(* +
)+ ,
;, -
Task 
< 	
List	 
< 
PurchaseDetail 
> 
>  
GetByPurchaseIdAsync 3
(3 4
int4 7

purchaseId8 B
)B C
;C D
Task

 
AddAsync

	 
(

 
PurchaseDetail

  
purchaseDetail

! /
)

/ 0
;

0 1
Task 
UpdateAsync	 
( 
PurchaseDetail #
purchaseDetail$ 2
)2 3
;3 4
} Á
C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\Interfaces\IProductRepository.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *

Interfaces* 4
;4 5
public 
	interface 
IProductRepository #
{ 
Task 
< 	
List	 
< 
Product 
> 
> 
GetAllAsync #
(# $
)$ %
;% &
Task 
AddAsync	 
( 
Product 
product !
)! "
;" #
} Æ
ŽC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\Interfaces\ICategoryRepository.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *

Interfaces* 4
;4 5
public 
	interface 
ICategoryRepository $
{ 
Task 
< 	
List	 
< 
Category 
> 
> 
GetAllAsync $
($ %
)% &
;& '
Task 
AddAsync	 
( 
Category 
category #
)# $
;$ %
} ¯
†C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\UpdateSupplierDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class 
UpdateSupplierDto 
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

string 
? 
Nit 
{ 
get 
; 
set !
;! "
}# $
public 

string 
? 
Address 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
Phone 
{ 
get 
; 
set  #
;# $
}% &
public		 

string		 
?		 
Email		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 

string

 
?

 
ContactName

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
} â
ˆC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\PurchaseResponseDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class 
PurchaseResponseDto  
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
Fecha 
{ 
get 
; 
set "
;" #
}$ %
=& '
string( .
.. /
Empty/ 4
;4 5
public 

string 
	Proveedor 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public		 

string		 
Total		 
{		 
get		 
;		 
set		 "
;		" #
}		$ %
=		& '
string		( .
.		. /
Empty		/ 4
;		4 5
public

 

bool

 
Expanded

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
=

' (
false

) .
;

. /
public 

List 
< %
PurchaseDetailResponseDto )
>) *
Detalles+ 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
=B C
newD G
(G H
)H I
;I J
} 
public 
class %
PurchaseDetailResponseDto &
{ 
public 

string 
Producto 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

short 
Cantidad 
{ 
get 
;  
set! $
;$ %
}& '
public 

decimal 
PrecioUnitario !
{" #
get$ '
;' (
set) ,
;, -
}. /
} ä
…C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\LoginResponseDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class 
LoginResponseDto 
{ 
public 

short 
Id 
{ 
get 
; 
set 
; 
}  !
public 

string 
Username 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 

string 
Role 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
} Æ
}C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\LoginDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class 
LoginDto 
{ 
public 

required 
string 
Username #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

required 
string 
Password #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} •
‚C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\CreateUserDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class 
CreateUserDto 
{ 
public 

required 
string 
Username #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

required 
string 
Password #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

required 
string 
	FirstName $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

required 
string 
LastName #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public		 

string		 
?		 
SecondLastName		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 

required

 
string

 
Role

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
} ¯
†C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\CreateSupplierDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class 
CreateSupplierDto 
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 

string 
? 
Nit 
{ 
get 
; 
set !
;! "
}# $
public 

string 
? 
Address 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
Phone 
{ 
get 
; 
set  #
;# $
}% &
public		 

string		 
?		 
Email		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 

string

 
?

 
ContactName

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
} ï
†C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\CreatePurchaseDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class 
CreatePurchaseDto 
{ 
public 

required 
short 

SupplierId $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

required 
List 
< #
CreatePurchaseDetailDto 0
>0 1
PurchaseDetails2 A
{B C
getD G
;G H
setI L
;L M
}N O
=P Q
newR U
(U V
)V W
;W X
} ˜
ŒC:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\CreatePurchaseDetailDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class #
CreatePurchaseDetailDto $
{ 
public 

required 
short 
	ProductId #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 

required 
short 
Quantity "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

required 
decimal 
	UnitPrice %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} Î

…C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\CreateProductDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class 
CreateProductDto 
{ 
public 

required 
short 
Id 
{ 
get "
;" #
set$ '
;' (
}) *
public 

required 
string 
Name 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
string0 6
.6 7
Empty7 <
;< =
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

required 
short 

CategoryId $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public		 

short		 

TotalStock		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
=		* +
$num		, -
;		- .
}

 ¥
†C:\Users\Adrian\source\repos\InventoryManagement\Backend\InventoryManagement\InventoryManagement\Application\DTOs\CreateCategoryDto.cs
	namespace 	
InventoryManagement
 
. 
Application )
.) *
DTOs* .
;. /
public 
class 
CreateCategoryDto 
{ 
public 

required 
string 
Name 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
string0 6
.6 7
Empty7 <
;< =
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 