<div class="modal-backdrop">
  <div class="form-card">
    <h3>{{ editMode ? 'Editar Proveedor' : 'Agregar Proveedor' }}</h3>

    <form #supplierForm="ngForm" (ngSubmit)="save()">
        <!-- NOMBRE -->
        <div class="form-group">
          <label for="name">Nombre</label>
          <input 
            [(ngModel)]="supplier.name"
            name="name"
            #name="ngModel"
            required
            minlength="4"
            pattern="^(?!^\d+$)[A-Za-zÁÉÍÓÚáéíóúÑñ0-9\s.,-]{4,31}$"
            placeholder="Ej: Distribuidora ABC"
          />

          <div class="error" *ngIf="getNameError(name)">
            <p>{{ getNameError(name) }}</p>
          </div>
        </div>

        <!-- NIT -->
        <div class="form-group">
          <label for="nit">Identificación Fiscal (NIT)</label>
          <input 
            [(ngModel)]="supplier.nit"
            name="nit"
            #nit="ngModel"
            required
            pattern="^[0-9]{7,12}-?[0-9A-Z]?$"
            placeholder="Ej: 12345678-9"
          />

          <div class="error" *ngIf="getNitError(nit)">
            <p>{{ getNitError(nit) }}</p>
          </div>
        </div>

        <!-- TELÉFONO -->
        <div class="form-group">
          <label for="phone">Teléfono</label>
          <div class="phone-group">
            <div class="custom-select-wrapper country-code-select">
              <div class="custom-select" 
                  [class.open]="showCountryDropdown"
                  (click)="toggleCountryDropdown()">
                <span class="select-value">{{ getSelectedCountryCode() }}</span>
                <span class="select-arrow">▼</span>
              </div>
              <div class="dropdown-menu" *ngIf="showCountryDropdown">
                <input type="text" 
                    class="dropdown-search"
                    placeholder="Buscar país..."
                    [value]="countrySearchTerm"
                    (input)="countrySearchTerm = $any($event.target).value"
                    (click)="$event.stopPropagation()">
                <div class="dropdown-options">
                  <div class="dropdown-option" 
                      *ngFor="let country of getFilteredCountries()"
                      (click)="selectCountry(country)">
                    {{ country.label }}
                  </div>
                  <div class="dropdown-option empty" 
                      *ngIf="getFilteredCountries().length === 0">
                    No se encontraron países
                  </div>
                </div>
              </div>
            </div>

            <input 
              type="text"
              [(ngModel)]="phoneNumber"
              name="phoneNumber"
              #phoneNumberRef="ngModel"
              required
              pattern="^[0-9]{6,10}$"
              placeholder="70000001"
            >
          </div>

          <div class="error" *ngIf="getPhoneError(phoneNumberRef)">
            <p>{{ getPhoneError(phoneNumberRef) }}</p>
          </div>
        </div>

        <!-- CORREO -->
        <div class="form-group">
          <label for="email">Correo Electrónico</label>
          <input 
            type="email"
            [(ngModel)]="supplier.email"
            name="email"
            #email="ngModel"
            required
            minlength="5"
            pattern="^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$"
            placeholder="Ej: contacto@empresa.com"
          >
          <div class="error" *ngIf="getEmailError(email)">
            <p>{{ getEmailError(email) }}</p>
          </div>
        </div>

        <!-- CONTACTO -->
        <div class="form-group">
          <label for="contactName">Nombre de Contacto</label>
          <input 
            [(ngModel)]="supplier.contactName"
            name="contactName"
            #contactName="ngModel"
            required
            minlength="2"
            pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$"
            placeholder="Ej: Juan Pérez"
          >
          <div class="error" *ngIf="getContactNameError(contactName)">
            <p>{{ getContactNameError(contactName) }}</p>
          </div>
        </div>

        <!-- DIRECCIÓN -->
        <div class="form-group">
          <label for="address">Dirección</label>
          <input 
            [(ngModel)]="supplier.address"
            name="address"
            #address="ngModel"
            required
            minlength="4"
            placeholder="Ej: Av. Blanco Galindo #123"
          >
          <div class="error" *ngIf="getAddressError(address)">
            <p>{{ getAddressError(address) }}</p>
          </div>
        </div>

      <div class="form-actions">
        <button class="cancel" type="button" (click)="cancel()">Cancelar</button>
        <button class="add" type="submit" [disabled]="supplierForm.invalid">
          {{ editMode ? 'Guardar Cambios' : 'Guardar' }}
        </button>
      </div>

      <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>
      <div class="success-message" *ngIf="successMessage">{{ successMessage }}</div>
    </form>
  </div>
</div>