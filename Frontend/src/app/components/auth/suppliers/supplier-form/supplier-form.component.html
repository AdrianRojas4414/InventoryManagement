<div class="modal-backdrop">
  <div class="form-card">
    <h3>{{ editMode ? 'Editar Proveedor' : 'Agregar Proveedor' }}</h3>

    <form #supplierForm="ngForm" (ngSubmit)="save()">

      <!-- NOMBRE -->
      <div class="form-group">
        <label for="name">Nombre</label>
        <input 
          [(ngModel)]="supplier.name"
          name="name"
          #name="ngModel"
          required
          maxlength="40"
          pattern="^(?!\\d+$)[A-Za-zÁÉÍÓÚáéíóúÑñ0-9\\s,.-]+$"
          placeholder="Ej: Distribuidora ABC"
        >
        <div class="error" *ngIf="name.invalid && (name.dirty || name.touched) || ((supplier.name || '').length > 40 && (name.dirty || name.touched))">
          <p *ngIf="name.errors?.['required']">El nombre es obligatorio.</p>
          <p *ngIf="(supplier.name || '').length > 40">Debe tener un máximo de 40 caracteres.</p>
          <p *ngIf="name.errors?.['pattern']">No puede ser solo números ni contener caracteres inválidos.</p>
        </div>
      </div>

      <!-- NIT -->
      <div class="form-group">
        <label for="nit">Identificación Fiscal (NIT)</label>
        <input 
          [(ngModel)]="supplier.nit"
          name="nit"
          #nit="ngModel"
          required
          pattern="^[0-9]{7,12}-?[0-9A-Z]?$"
          placeholder="Ej: 12345678-9"
        >
        <div class="error" *ngIf="nit.invalid && (nit.dirty || nit.touched) || ((supplier.nit || '').length > 15 && (nit.dirty || nit.touched))">
          <p *ngIf="nit.errors?.['required']">El NIT es obligatorio.</p>
          <p *ngIf="(supplier.nit || '').length > 15">Debe tener un máximo de 15 caracteres.</p>
          <p *ngIf="nit.errors?.['pattern']">Formato inválido. Ejemplo: 12345678-9</p>
        </div>
      </div>

      <!-- CORREO -->
      <div class="form-group">
        <label for="email">Correo Electrónico</label>
        <input 
          type="email"
          [(ngModel)]="supplier.email"
          name="email"
          #email="ngModel"
          required
          maxlength="50"
          pattern="^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$"
          placeholder="Ej: contacto@empresa.com"
        >
        <div class="error" *ngIf="email.invalid && (email.dirty || email.touched) || ((supplier.email || '').length > 50 && (email.dirty || email.touched))">
          <p *ngIf="email.errors?.['required']">El correo es obligatorio.</p>
          <p *ngIf="email.errors?.['pattern']">Debe tener un formato válido (ej. usuario&#64;dominio.com).</p>
          <p *ngIf="(supplier.email || '').length > 50">Debe tener un máximo de 50 caracteres.</p>
        </div>
      </div>

      <!-- CONTACTO -->
      <div class="form-group">
        <label for="contactName">Nombre de Contacto</label>
        <input 
          [(ngModel)]="supplier.contactName"
          name="contactName"
          #contactName="ngModel"
          required
          maxlength="40"
          pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ\\s]+$"
          placeholder="Ej: Juan Pérez"
        >
        <div class="error" *ngIf="contactName.invalid && (contactName.dirty || contactName.touched) || ((supplier.contactName || '').length > 40 && (contactName.dirty || contactName.touched))">
          <p *ngIf="contactName.errors?.['required']">El nombre de contacto es obligatorio.</p>
          <p *ngIf="contactName.errors?.['pattern']">Solo se permiten letras y espacios.</p>
          <p *ngIf="(supplier.contactName || '').length > 40">Debe tener un máximo de 40 caracteres.</p>
        </div>
      </div>

      <!-- DIRECCIÓN -->
      <div class="form-group">
        <label for="address">Dirección</label>
        <input 
          [(ngModel)]="supplier.address"
          name="address"
          #address="ngModel"
          required
          maxlength="60"
          placeholder="Ej: Av. Blanco Galindo #123"
        >
        <div class="error" *ngIf="address.invalid && (address.dirty || address.touched) || ((supplier.address || '').length > 60 && (address.dirty || address.touched))">
          <p *ngIf="address.errors?.['required']">La dirección es obligatoria.</p>
          <p *ngIf="(supplier.address || '').length > 60">Debe tener un máximo de 60 caracteres.</p>
        </div>
      </div>

      <div class="form-actions">
        <button class="cancel" type="button" (click)="cancel()">Cancelar</button>
        <button class="add" type="submit" [disabled]="supplierForm.invalid">
          {{ editMode ? 'Guardar Cambios' : 'Guardar' }}
        </button>
      </div>

      <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>
      <div class="success-message" *ngIf="successMessage">{{ successMessage }}</div>

    </form>
  </div>
</div>
