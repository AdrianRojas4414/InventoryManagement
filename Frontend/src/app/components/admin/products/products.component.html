<div>
  <app-sidebar></app-sidebar>
  <main>
    <header class="header">
      <h1>Products</h1>
      <h2>Manage your product inventory and track stock levels</h2>
      <div class="actions">
        <button class="add" (click)="openProductForm()">+ Add Product</button>
        <button class="add" (click)="openCategoryForm()">+ Add Category</button>
      </div>
    </header>

    <!-- Formulario Categoría -->
    <ng-container *ngIf="showCategoryForm">
      <div class="modal-backdrop">
        <div class="form-card">
          <h3>{{ editCategoryMode ? 'Edit Category' : 'Add New Category' }}</h3>
          <form (ngSubmit)="saveCategory()">
            <div class="form-group">
              <label for="category-name">Category Name</label>
              <input id="category-name" [(ngModel)]="currentCategory.name" name="name" required>
            </div>
            <div class="form-group">
              <label for="category-description">Description</label>
              <input id="category-description" [(ngModel)]="currentCategory.description" name="description" required>
            </div>
            <div class="form-actions">
              <button type="button" class="cancel" (click)="closeFormCategory()">Cancel</button>
              <button type="submit" class="add">{{ editCategoryMode ? 'Save Changes' : 'Add' }}</button>
            </div>
          </form>
        </div>
      </div>
    </ng-container>

    <!-- Formulario Producto -->
    <ng-container *ngIf="showProductForm">
      <div class="modal-backdrop">
        <div class="form-card">
          <h3>{{ editProductMode ? 'Edit Product' : 'Add New Product' }}</h3>
          <form (ngSubmit)="saveProduct()">
            <div class="form-grid">
              <div class="form-group">
                <label for="product-name">Product Name</label>
                <input id="product-name" [(ngModel)]="currentProduct.name" name="name" required>
              </div>
              <div class="form-group">
                <label for="product-description">Description</label>
                <input id="product-description" [(ngModel)]="currentProduct.description" name="description" required>
              </div>
              <div class="form-group">
                <label for="product-category">Category</label>
                <select id="product-category" [(ngModel)]="currentProduct.categoryId" name="categoryId" required>
                  <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</option>
                </select>
              </div>
              <div class="form-group">
                <label for="product-stock">Stock</label>
                <input id="product-stock" type="number" [(ngModel)]="currentProduct.totalStock" name="totalStock" required>
              </div>
            </div>
            <div class="form-actions">
              <button type="button" class="cancel" (click)="closeForm()">Cancel</button>
              <button type="submit" class="add">{{ editProductMode ? 'Save Changes' : 'Add Product' }}</button>
            </div>
          </form>
        </div>
      </div>
    </ng-container>

    <!-- Tabla Productos -->
    <section class="table-container">
      <table class="product-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Category</th>
            <th>Description</th>
            <th>Stock</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of products">
            <td>{{ product.id }}</td>
            <td>{{ product.name }}</td>
            <td><span class="category-tag">{{ product.categoryName }}</span></td>
            <td class="description">{{ product.description }}</td>
            <td [ngClass]="{
                'stock-low': product.totalStock > 0 && product.totalStock <= 10,
                'stock-out': product.totalStock === 0
            }">{{ product.totalStock }}</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Tabla Categorías -->
    <section class="table-container">
      <table class="product-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let category of categories">
            <td>{{ category.id }}</td>
            <td>{{ category.name }}</td>
            <td class="description">{{ category.description }}</td>
          </tr>
        </tbody>
      </table>
    </section>
  </main>
</div>
